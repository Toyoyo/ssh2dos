<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Watt-32 tcp/ip: /home/fosco/src/SSH2DOS/watt32/src/pcsed.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Watt-32 tcp/ip
   &#160;<span id="projectnumber">2.2 dev-rel.10</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('pcsed_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">pcsed.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="pcsed_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7c1ce6ca70753560aa2020d04ef292ce"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *W32_CALL *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#a7c1ce6ca70753560aa2020d04ef292ce">_eth_recv_hook</a> (WORD *type)</td></tr>
<tr class="memdesc:a7c1ce6ca70753560aa2020d04ef292ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to functions that when set changes the behaviour of polling and send functions <a class="el" href="pcsed_8c.html#ae158a0791f36d20f60aa9db52f48b147" title="Poll for arrival of new packets (IP/ARP/RARP/PPPoE protocol). ">_eth_arrived()</a> and <a class="el" href="pcsed_8c.html#a6ba624fcff27ce605d72837152781f84" title="_eth_send() does the actual transmission once we are complete with filling the buffer. ">_eth_send()</a>.  <a href="#a7c1ce6ca70753560aa2020d04ef292ce">More...</a><br /></td></tr>
<tr class="separator:a7c1ce6ca70753560aa2020d04ef292ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b84ceb5642ee9a27569353ae913b714"><td class="memItemLeft" align="right" valign="top"><a id="a5b84ceb5642ee9a27569353ae913b714"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>int</b> (W32_CALL *_eth_recv_peek)(<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *mac_buf)</td></tr>
<tr class="separator:a5b84ceb5642ee9a27569353ae913b714"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdcbbdb76904d7b435759154890e5ee9"><td class="memItemLeft" align="right" valign="top"><a id="abdcbbdb76904d7b435759154890e5ee9"></a>
static <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#abdcbbdb76904d7b435759154890e5ee9">__eth_release</a> (<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>)</td></tr>
<tr class="memdesc:abdcbbdb76904d7b435759154890e5ee9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn off stack-checking because <a class="el" href="pcsed_8c.html#a0aa9a8df5ee321c604851302ed3e19ae" title="Release the hardware driver. ">_eth_release()</a> might be called from an exception handler. <br /></td></tr>
<tr class="separator:abdcbbdb76904d7b435759154890e5ee9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a678e0c9c11a6eb345ad17e36fb0b162b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#a678e0c9c11a6eb345ad17e36fb0b162b">_eth_formatpacket</a> (const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *mac_dest, WORD eth_type)</td></tr>
<tr class="memdesc:a678e0c9c11a6eb345ad17e36fb0b162b"><td class="mdescLeft">&#160;</td><td class="mdescRight">_eth_format_packet() places the next packet to be transmitted into the above link-layer output packet.  <a href="#a678e0c9c11a6eb345ad17e36fb0b162b">More...</a><br /></td></tr>
<tr class="separator:a678e0c9c11a6eb345ad17e36fb0b162b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf475c1f22283fe7fd921faf88c81715"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#adf475c1f22283fe7fd921faf88c81715">send_loopback</a> (<a class="el" href="unionlink___packet.html">link_Packet</a> pkt, BOOL is_ip6, unsigned *err_line)</td></tr>
<tr class="memdesc:adf475c1f22283fe7fd921faf88c81715"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enqueue a link-layer frame (IPv4/v6 only) to the internal loopback device.  <a href="#adf475c1f22283fe7fd921faf88c81715">More...</a><br /></td></tr>
<tr class="separator:adf475c1f22283fe7fd921faf88c81715"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ba624fcff27ce605d72837152781f84"><td class="memItemLeft" align="right" valign="top">int W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#a6ba624fcff27ce605d72837152781f84">_eth_send</a> (WORD len, const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *sock, const char *file, unsigned line)</td></tr>
<tr class="memdesc:a6ba624fcff27ce605d72837152781f84"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="pcsed_8c.html#a6ba624fcff27ce605d72837152781f84" title="_eth_send() does the actual transmission once we are complete with filling the buffer. ">_eth_send()</a> does the actual transmission once we are complete with filling the buffer.  <a href="#a6ba624fcff27ce605d72837152781f84">More...</a><br /></td></tr>
<tr class="separator:a6ba624fcff27ce605d72837152781f84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82ad60bfa206e223b784e500532b2103"><td class="memItemLeft" align="right" valign="top"><a id="a82ad60bfa206e223b784e500532b2103"></a>
static <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#a82ad60bfa206e223b784e500532b2103">eth_mac_format</a> (<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *mac_buf, const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *mac_dest, WORD type)</td></tr>
<tr class="memdesc:a82ad60bfa206e223b784e500532b2103"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format the MAC-header for Ethernet. <br /></td></tr>
<tr class="separator:a82ad60bfa206e223b784e500532b2103"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53f1f417afa7028b76dc39c7c9bcc2af"><td class="memItemLeft" align="right" valign="top"><a id="a53f1f417afa7028b76dc39c7c9bcc2af"></a>
static <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#a53f1f417afa7028b76dc39c7c9bcc2af">tok_mac_format</a> (<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *mac_buf, const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *mac_dest, WORD type)</td></tr>
<tr class="memdesc:a53f1f417afa7028b76dc39c7c9bcc2af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format the MAC-header for Token-Ring. <br /></td></tr>
<tr class="separator:a53f1f417afa7028b76dc39c7c9bcc2af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb9ce8c885e0d1c4ef2e811118fc1ecb"><td class="memItemLeft" align="right" valign="top"><a id="abb9ce8c885e0d1c4ef2e811118fc1ecb"></a>
static <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#abb9ce8c885e0d1c4ef2e811118fc1ecb">fddi_mac_format</a> (<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *mac_buf, const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *mac_dest, WORD type)</td></tr>
<tr class="memdesc:abb9ce8c885e0d1c4ef2e811118fc1ecb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format the MAC-header for FDDI. <br /></td></tr>
<tr class="separator:abb9ce8c885e0d1c4ef2e811118fc1ecb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1c5c22cb024b5a05c74052044005a6c"><td class="memItemLeft" align="right" valign="top"><a id="ad1c5c22cb024b5a05c74052044005a6c"></a>
static <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#ad1c5c22cb024b5a05c74052044005a6c">arcnet_mac_format</a> (<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *mac_buf, const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *mac_dest, WORD type)</td></tr>
<tr class="memdesc:ad1c5c22cb024b5a05c74052044005a6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format the MAC-header for ARCNET. <br /></td></tr>
<tr class="separator:ad1c5c22cb024b5a05c74052044005a6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cfc2014559e0c222715da2a1f869e89"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#a6cfc2014559e0c222715da2a1f869e89">null_mac_format</a> (<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *mac_buf, const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *mac_dest, WORD type)</td></tr>
<tr class="memdesc:a6cfc2014559e0c222715da2a1f869e89"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format MAC-header for protocols without MAC-headers.  <a href="#a6cfc2014559e0c222715da2a1f869e89">More...</a><br /></td></tr>
<tr class="separator:a6cfc2014559e0c222715da2a1f869e89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04eaed5d7167215b5d490fa887f2057a"><td class="memItemLeft" align="right" valign="top"><a id="a04eaed5d7167215b5d490fa887f2057a"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#a04eaed5d7167215b5d490fa887f2057a">eth_mac_xmit</a> (const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *buf, WORD len)</td></tr>
<tr class="memdesc:a04eaed5d7167215b5d490fa887f2057a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Functions called via function pointer `mac_transmit' to actually send the data. <br /></td></tr>
<tr class="separator:a04eaed5d7167215b5d490fa887f2057a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10a516eb7cd438fd258f40d213e66b13"><td class="memItemLeft" align="right" valign="top"><a id="a10a516eb7cd438fd258f40d213e66b13"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>fddi_mac_xmit</b> (const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *buf, WORD len)</td></tr>
<tr class="separator:a10a516eb7cd438fd258f40d213e66b13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a521a50288fd79dbcd4fa63b46c370c17"><td class="memItemLeft" align="right" valign="top"><a id="a521a50288fd79dbcd4fa63b46c370c17"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>arcnet_mac_xmit</b> (const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *buf, WORD len)</td></tr>
<tr class="separator:a521a50288fd79dbcd4fa63b46c370c17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4717d2b769884b970478f705646d60e"><td class="memItemLeft" align="right" valign="top"><a id="ae4717d2b769884b970478f705646d60e"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>tok_mac_xmit</b> (const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *buf, WORD len)</td></tr>
<tr class="separator:ae4717d2b769884b970478f705646d60e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2b339d38760643593b4fb39e07c4ef8"><td class="memItemLeft" align="right" valign="top"><a id="ad2b339d38760643593b4fb39e07c4ef8"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>null_mac_xmit</b> (const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *buf, WORD len)</td></tr>
<tr class="separator:ad2b339d38760643593b4fb39e07c4ef8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ebff273481692ad4e8f673521de12ba"><td class="memItemLeft" align="right" valign="top">int W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#a9ebff273481692ad4e8f673521de12ba">_eth_init</a> (<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>)</td></tr>
<tr class="memdesc:a9ebff273481692ad4e8f673521de12ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the network driver interface.  <a href="#a9ebff273481692ad4e8f673521de12ba">More...</a><br /></td></tr>
<tr class="separator:a9ebff273481692ad4e8f673521de12ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a795efeca78862f60189a3e112211d1de"><td class="memItemLeft" align="right" valign="top"><a id="a795efeca78862f60189a3e112211d1de"></a>
int W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#a795efeca78862f60189a3e112211d1de">_eth_set_addr</a> (const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *addr)</td></tr>
<tr class="memdesc:a795efeca78862f60189a3e112211d1de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets a new MAC address for our interface. <br /></td></tr>
<tr class="separator:a795efeca78862f60189a3e112211d1de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac99e2e09777b69721e991ede780ea3fb"><td class="memItemLeft" align="right" valign="top">BYTE W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#ac99e2e09777b69721e991ede780ea3fb">_eth_get_hwtype</a> (BYTE *hwtype, BYTE *hwlen)</td></tr>
<tr class="memdesc:ac99e2e09777b69721e991ede780ea3fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill in hardware address type/length for BOOTP/DHCP packets.  <a href="#ac99e2e09777b69721e991ede780ea3fb">More...</a><br /></td></tr>
<tr class="separator:ac99e2e09777b69721e991ede780ea3fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe5dcd5a9a1a3dec831f0883d475096a"><td class="memItemLeft" align="right" valign="top"><a id="afe5dcd5a9a1a3dec831f0883d475096a"></a>
<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#afe5dcd5a9a1a3dec831f0883d475096a">_eth_free</a> (const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *pkt)</td></tr>
<tr class="memdesc:afe5dcd5a9a1a3dec831f0883d475096a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free an input buffer once it is no longer needed. <br /></td></tr>
<tr class="separator:afe5dcd5a9a1a3dec831f0883d475096a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c2e09e726b7d7b3049ed987e685fea2"><td class="memItemLeft" align="right" valign="top"><a id="a9c2e09e726b7d7b3049ed987e685fea2"></a>
static <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><b>fix_tok_head</b> (<a class="el" href="structtok___header.html">tok_Header</a> **trp)</td></tr>
<tr class="separator:a9c2e09e726b7d7b3049ed987e685fea2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ca30c79f2ec8b0562e724341561eb32"><td class="memItemLeft" align="right" valign="top"><a id="a8ca30c79f2ec8b0562e724341561eb32"></a>
static BOOL&#160;</td><td class="memItemRight" valign="bottom"><b>fix_arc_head</b> (const <a class="el" href="structarcnet___header.html">arcnet_Header</a> *head, WORD *type)</td></tr>
<tr class="separator:a8ca30c79f2ec8b0562e724341561eb32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56d7fe2ec0e9444b7492f32ccf8065ee"><td class="memItemLeft" align="right" valign="top">static union <a class="el" href="unionlink___packet.html">link_Packet</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#a56d7fe2ec0e9444b7492f32ccf8065ee">poll_recv_queue</a> (WORD *type)</td></tr>
<tr class="memdesc:a56d7fe2ec0e9444b7492f32ccf8065ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Poll the packet queue.  <a href="#a56d7fe2ec0e9444b7492f32ccf8065ee">More...</a><br /></td></tr>
<tr class="separator:a56d7fe2ec0e9444b7492f32ccf8065ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa991e4288fdba0dca6be4ae3ac445912"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#aa991e4288fdba0dca6be4ae3ac445912">fix_llc_head</a> (<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> **mac)</td></tr>
<tr class="separator:aa991e4288fdba0dca6be4ae3ac445912"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae158a0791f36d20f60aa9db52f48b147"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#ae158a0791f36d20f60aa9db52f48b147">_eth_arrived</a> (WORD *type_ptr, BOOL *broadcast)</td></tr>
<tr class="memdesc:ae158a0791f36d20f60aa9db52f48b147"><td class="mdescLeft">&#160;</td><td class="mdescRight">Poll for arrival of new packets (IP/ARP/RARP/PPPoE protocol).  <a href="#ae158a0791f36d20f60aa9db52f48b147">More...</a><br /></td></tr>
<tr class="separator:ae158a0791f36d20f60aa9db52f48b147"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ce1e3ee77c6aebb871c1deac2930e63"><td class="memItemLeft" align="right" valign="top"><a id="a5ce1e3ee77c6aebb871c1deac2930e63"></a>
<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#a5ce1e3ee77c6aebb871c1deac2930e63">_eth_mac_hdr</a> (const <a class="el" href="structin___header.html">in_Header</a> *ip)</td></tr>
<tr class="memdesc:a5ce1e3ee77c6aebb871c1deac2930e63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to MAC header start address of an IP packet. <br /></td></tr>
<tr class="separator:a5ce1e3ee77c6aebb871c1deac2930e63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26ed56339cbca6e628e30d9708c11dbc"><td class="memItemLeft" align="right" valign="top"><a id="a26ed56339cbca6e628e30d9708c11dbc"></a>
<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#a26ed56339cbca6e628e30d9708c11dbc">_eth_mac_dst</a> (const <a class="el" href="structin___header.html">in_Header</a> *ip)</td></tr>
<tr class="memdesc:a26ed56339cbca6e628e30d9708c11dbc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to MAC destination address of an IP packet. <br /></td></tr>
<tr class="separator:a26ed56339cbca6e628e30d9708c11dbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae076aca772404c2e03699392fcd300b4"><td class="memItemLeft" align="right" valign="top"><a id="ae076aca772404c2e03699392fcd300b4"></a>
<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#ae076aca772404c2e03699392fcd300b4">_eth_mac_src</a> (const <a class="el" href="structin___header.html">in_Header</a> *ip)</td></tr>
<tr class="memdesc:ae076aca772404c2e03699392fcd300b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return pointer to MAC source address of an IP packet. <br /></td></tr>
<tr class="separator:ae076aca772404c2e03699392fcd300b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d959a0b71b8d5f6f4e00819dc85ab7d"><td class="memItemLeft" align="right" valign="top"><a id="a1d959a0b71b8d5f6f4e00819dc85ab7d"></a>
WORD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#a1d959a0b71b8d5f6f4e00819dc85ab7d">_eth_mac_typ</a> (const <a class="el" href="structin___header.html">in_Header</a> *ip)</td></tr>
<tr class="memdesc:a1d959a0b71b8d5f6f4e00819dc85ab7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return value of protocol-type given an IP packet. <br /></td></tr>
<tr class="separator:a1d959a0b71b8d5f6f4e00819dc85ab7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aef6f9556ff4f2449be88a4e1e9e853"><td class="memItemLeft" align="right" valign="top">BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#a1aef6f9556ff4f2449be88a4e1e9e853">_eth_join_mcast_group</a> (const struct <a class="el" href="struct_multi_cast.html">MultiCast</a> *mc)</td></tr>
<tr class="memdesc:a1aef6f9556ff4f2449be88a4e1e9e853"><td class="mdescLeft">&#160;</td><td class="mdescRight">Joins a multicast group (at the physical layer).  <a href="#a1aef6f9556ff4f2449be88a4e1e9e853">More...</a><br /></td></tr>
<tr class="separator:a1aef6f9556ff4f2449be88a4e1e9e853"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a237151e881e958bd4c2827e9fe03bb0d"><td class="memItemLeft" align="right" valign="top">BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#a237151e881e958bd4c2827e9fe03bb0d">_eth_leave_mcast_group</a> (const struct <a class="el" href="struct_multi_cast.html">MultiCast</a> *mc)</td></tr>
<tr class="memdesc:a237151e881e958bd4c2827e9fe03bb0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Leaves a multicast group (at the physical layer)  <a href="#a237151e881e958bd4c2827e9fe03bb0d">More...</a><br /></td></tr>
<tr class="separator:a237151e881e958bd4c2827e9fe03bb0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0aa9a8df5ee321c604851302ed3e19ae"><td class="memItemLeft" align="right" valign="top"><a id="a0aa9a8df5ee321c604851302ed3e19ae"></a>
<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#a0aa9a8df5ee321c604851302ed3e19ae">_eth_release</a> (<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>)</td></tr>
<tr class="memdesc:a0aa9a8df5ee321c604851302ed3e19ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Release the hardware driver. <br /></td></tr>
<tr class="separator:a0aa9a8df5ee321c604851302ed3e19ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a6f600dba24a8c803d8b79a0b3ea13dcf"><td class="memItemLeft" align="right" valign="top"><a id="a6f600dba24a8c803d8b79a0b3ea13dcf"></a>
mac_address&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#a6f600dba24a8c803d8b79a0b3ea13dcf">_eth_addr</a></td></tr>
<tr class="memdesc:a6f600dba24a8c803d8b79a0b3ea13dcf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Local link-layer source address. <br /></td></tr>
<tr class="separator:a6f600dba24a8c803d8b79a0b3ea13dcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa87831d9461443d2932099e98b873c6"><td class="memItemLeft" align="right" valign="top"><a id="afa87831d9461443d2932099e98b873c6"></a>
mac_address&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#afa87831d9461443d2932099e98b873c6">_eth_brdcast</a></td></tr>
<tr class="memdesc:afa87831d9461443d2932099e98b873c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Link-layer broadcast address. <br /></td></tr>
<tr class="separator:afa87831d9461443d2932099e98b873c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60f067e28c66c99fa7d5c914abc66a24"><td class="memItemLeft" align="right" valign="top"><a id="a60f067e28c66c99fa7d5c914abc66a24"></a>
mac_address&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#a60f067e28c66c99fa7d5c914abc66a24">_eth_loop_addr</a></td></tr>
<tr class="memdesc:a60f067e28c66c99fa7d5c914abc66a24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Link-layer loopback address. <br /></td></tr>
<tr class="separator:a60f067e28c66c99fa7d5c914abc66a24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc0f6dfc4afba836d74236fda8987c45"><td class="memItemLeft" align="right" valign="top"><a id="afc0f6dfc4afba836d74236fda8987c45"></a>
mac_address&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#afc0f6dfc4afba836d74236fda8987c45">_eth_real_addr</a></td></tr>
<tr class="memdesc:afc0f6dfc4afba836d74236fda8987c45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Our real MAC address. <br /></td></tr>
<tr class="separator:afc0f6dfc4afba836d74236fda8987c45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad579a5a4f1f0afef1a5c1cd59baee80f"><td class="memItemLeft" align="right" valign="top"><a id="ad579a5a4f1f0afef1a5c1cd59baee80f"></a>
BYTE&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#ad579a5a4f1f0afef1a5c1cd59baee80f">_eth_mac_len</a></td></tr>
<tr class="memdesc:ad579a5a4f1f0afef1a5c1cd59baee80f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of a MAC address. <br /></td></tr>
<tr class="separator:ad579a5a4f1f0afef1a5c1cd59baee80f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b1545536fc7530fde9b30ced3127633"><td class="memItemLeft" align="right" valign="top"><a id="a1b1545536fc7530fde9b30ced3127633"></a>
BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#a1b1545536fc7530fde9b30ced3127633">_eth_is_init</a> = FALSE</td></tr>
<tr class="memdesc:a1b1545536fc7530fde9b30ced3127633"><td class="mdescLeft">&#160;</td><td class="mdescRight">we are initialised <br /></td></tr>
<tr class="separator:a1b1545536fc7530fde9b30ced3127633"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad146672b018e57c000c941dcdcbd93fb"><td class="memItemLeft" align="right" valign="top"><a id="ad146672b018e57c000c941dcdcbd93fb"></a>
BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#ad146672b018e57c000c941dcdcbd93fb">_ip_recursion</a> = FALSE</td></tr>
<tr class="memdesc:ad146672b018e57c000c941dcdcbd93fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">avoid recursion in arp_resolve() <br /></td></tr>
<tr class="separator:ad146672b018e57c000c941dcdcbd93fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fc79c154b875d70dd589f13cc279fcd"><td class="memItemLeft" align="right" valign="top"><a id="a2fc79c154b875d70dd589f13cc279fcd"></a>
BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#a2fc79c154b875d70dd589f13cc279fcd">_eth_ndis3pkt</a> = FALSE</td></tr>
<tr class="memdesc:a2fc79c154b875d70dd589f13cc279fcd"><td class="mdescLeft">&#160;</td><td class="mdescRight">for DOS-programs only <br /></td></tr>
<tr class="separator:a2fc79c154b875d70dd589f13cc279fcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf4c3c515ce9db222b054a71bbaf8a4b"><td class="memItemLeft" align="right" valign="top"><a id="acf4c3c515ce9db222b054a71bbaf8a4b"></a>
BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#acf4c3c515ce9db222b054a71bbaf8a4b">_eth_SwsVpkt</a> = FALSE</td></tr>
<tr class="memdesc:acf4c3c515ce9db222b054a71bbaf8a4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">for DOS <em>and</em> Win32 programs <br /></td></tr>
<tr class="separator:acf4c3c515ce9db222b054a71bbaf8a4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72c5328464e8036be75a467753cfcdeb"><td class="memItemLeft" align="right" valign="top"><a id="a72c5328464e8036be75a467753cfcdeb"></a>
BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#a72c5328464e8036be75a467753cfcdeb">_eth_airpcap</a> = FALSE</td></tr>
<tr class="memdesc:a72c5328464e8036be75a467753cfcdeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">for Win32 using the AirPcap adapter <br /></td></tr>
<tr class="separator:a72c5328464e8036be75a467753cfcdeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab94b5a0e3412c77559717f62d481ea84"><td class="memItemLeft" align="right" valign="top"><a id="ab94b5a0e3412c77559717f62d481ea84"></a>
BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#ab94b5a0e3412c77559717f62d481ea84">_eth_wanpacket</a> = FALSE</td></tr>
<tr class="memdesc:ab94b5a0e3412c77559717f62d481ea84"><td class="mdescLeft">&#160;</td><td class="mdescRight">for Win32 using an WanPacket adapter <br /></td></tr>
<tr class="separator:ab94b5a0e3412c77559717f62d481ea84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaecad6946b022eab33a47af46e656ce5"><td class="memItemLeft" align="right" valign="top"><a id="aaecad6946b022eab33a47af46e656ce5"></a>
BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#aaecad6946b022eab33a47af46e656ce5">_eth_npcap</a> = FALSE</td></tr>
<tr class="memdesc:aaecad6946b022eab33a47af46e656ce5"><td class="mdescLeft">&#160;</td><td class="mdescRight">for Win32 using an NPcap adapter <br /></td></tr>
<tr class="separator:aaecad6946b022eab33a47af46e656ce5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5883ec1edfe40e3fe3fbb4ec599a8c51"><td class="memItemLeft" align="right" valign="top"><a id="a5883ec1edfe40e3fe3fbb4ec599a8c51"></a>
BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#a5883ec1edfe40e3fe3fbb4ec599a8c51">_eth_win10pcap</a> = FALSE</td></tr>
<tr class="memdesc:a5883ec1edfe40e3fe3fbb4ec599a8c51"><td class="mdescLeft">&#160;</td><td class="mdescRight">for Win32 using an Win10Pcap adapter <br /></td></tr>
<tr class="separator:a5883ec1edfe40e3fe3fbb4ec599a8c51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe02718062482dcf18f662b14beadab5"><td class="memItemLeft" align="right" valign="top"><a id="abe02718062482dcf18f662b14beadab5"></a>
BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#abe02718062482dcf18f662b14beadab5">_eth_winpcap</a> = FALSE</td></tr>
<tr class="memdesc:abe02718062482dcf18f662b14beadab5"><td class="mdescLeft">&#160;</td><td class="mdescRight">for Win32 using an WinPcap adapter (default) <br /></td></tr>
<tr class="separator:abe02718062482dcf18f662b14beadab5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1641eda022024f93b130f5291b0bcbeb"><td class="memItemLeft" align="right" valign="top"><a id="a1641eda022024f93b130f5291b0bcbeb"></a>
const char *&#160;</td><td class="memItemRight" valign="bottom"><b>_eth_not_init</b> = &quot;Packet driver not initialised&quot;</td></tr>
<tr class="separator:a1641eda022024f93b130f5291b0bcbeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c6006faeb8b9c6c5a8d501d5e4e6ebe"><td class="memItemLeft" align="right" valign="top"><a id="a1c6006faeb8b9c6c5a8d501d5e4e6ebe"></a>
struct _eth_last_info&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#a1c6006faeb8b9c6c5a8d501d5e4e6ebe">_eth_last</a></td></tr>
<tr class="memdesc:a1c6006faeb8b9c6c5a8d501d5e4e6ebe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sizes and timestamps of last packet recv/sent. <br /></td></tr>
<tr class="separator:a1c6006faeb8b9c6c5a8d501d5e4e6ebe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4960e0db764d064fd8e2ed33fe9bdbe9"><td class="memItemLeft" align="right" valign="top"><a id="a4960e0db764d064fd8e2ed33fe9bdbe9"></a>
unsigned&#160;</td><td class="memItemRight" valign="bottom"><b>len</b> = NULL</td></tr>
<tr class="separator:a4960e0db764d064fd8e2ed33fe9bdbe9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade90d948435190c456ade74139f19df4"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcsed_8c.html#ade90d948435190c456ade74139f19df4">mac_tx_format</a> )(<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *mac_buf, const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *mac_dest, WORD type)</td></tr>
<tr class="memdesc:ade90d948435190c456ade74139f19df4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to functions that does the filling of correct MAC-header and sends the link-layer packet.  <a href="#ade90d948435190c456ade74139f19df4">More...</a><br /></td></tr>
<tr class="separator:ade90d948435190c456ade74139f19df4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aace0368e6508894eb0b44a17fd8494f9"><td class="memItemLeft" align="right" valign="top"><a id="aace0368e6508894eb0b44a17fd8494f9"></a>
static int(*&#160;</td><td class="memItemRight" valign="bottom"><b>mac_transmit</b> )(const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *mac_buf, WORD len)</td></tr>
<tr class="separator:aace0368e6508894eb0b44a17fd8494f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a115d94462af2ce321159f5e299b5121e"><td class="memItemLeft" align="right" valign="top"><a id="a115d94462af2ce321159f5e299b5121e"></a>
static WORD&#160;</td><td class="memItemRight" valign="bottom"><b>proto</b></td></tr>
<tr class="separator:a115d94462af2ce321159f5e299b5121e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52e2c8f9995b8e7f3f2856e469188b11"><td class="memItemLeft" align="right" valign="top"><a id="a52e2c8f9995b8e7f3f2856e469188b11"></a>
static <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>nw_pkt</b></td></tr>
<tr class="separator:a52e2c8f9995b8e7f3f2856e469188b11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a678d0277fbf95332adb8a9b562518e47"><td class="memItemLeft" align="right" valign="top"><a id="a678d0277fbf95332adb8a9b562518e47"></a>
static union <a class="el" href="unionlink___packet.html">link_Packet</a>&#160;</td><td class="memItemRight" valign="bottom"><b>outbuf</b></td></tr>
<tr class="separator:a678d0277fbf95332adb8a9b562518e47"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Link-layer Driver Routines.</p>
<p>The TCP code uses Ethernet constants for protocol numbers and 48 bits for address. Also, 0xFF:FF:FF:FF:FF:FF is assumed to be a broadcast. Except for ARCNET where broadcast is 0x00.</p>
<p>If you need to write a new driver, implement it at this level and use the above mentioned constants as this program's constants, not device dependent constants.</p>
<p>The packet driver or WinPcap interface code lies below this module. </p>

<p class="definition">Definition in file <a class="el" href="pcsed_8c_source.html">pcsed.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ae158a0791f36d20f60aa9db52f48b147"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae158a0791f36d20f60aa9db52f48b147">&#9670;&nbsp;</a></span>_eth_arrived()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>* W32_CALL _eth_arrived </td>
          <td>(</td>
          <td class="paramtype">WORD *&#160;</td>
          <td class="paramname"><em>type_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BOOL *&#160;</td>
          <td class="paramname"><em>broadcast</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Poll for arrival of new packets (IP/ARP/RARP/PPPoE protocol). </p>
<p>Sets protocol-type of packet received in 'type'.</p>
<p>For Ethernet/TokenRing-type drivers: <br />
 </p><dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Pointer</td><td>past the MAC-header to the IP/ARP/RARP protocol header. Also check for link-layer broadcast.</td></tr>
  </table>
  </dd>
</dl>
<p>For PPP/SLIP-type drivers (no MAC-headers): <br />
 </p><dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">Pointer</td><td>to the IP-packet itself. IP-protocol is assumed. Can never be link-layer broadcast. </td></tr>
  </table>
  </dd>
</dl>
<p>&lt;</p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000083">Todo:</a></b></dt><dd>push back packet, else it's lost </dd></dl>

<p class="definition">Definition at line <a class="el" href="pcsed_8c_source.html#l01028">1028</a> of file <a class="el" href="pcsed_8c_source.html">pcsed.c</a>.</p>

</div>
</div>
<a id="a678e0c9c11a6eb345ad17e36fb0b162b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a678e0c9c11a6eb345ad17e36fb0b162b">&#9670;&nbsp;</a></span>_eth_formatpacket()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>* W32_CALL _eth_formatpacket </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *&#160;</td>
          <td class="paramname"><em>mac_dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">WORD&#160;</td>
          <td class="paramname"><em>eth_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>_eth_format_packet() places the next packet to be transmitted into the above link-layer output packet. </p>
<dl class="section return"><dt>Returns</dt><dd>address of higher-level protocol (IP/RARP/RARP) header. </dd></dl>

<p class="definition">Definition at line <a class="el" href="pcsed_8c_source.html#l00137">137</a> of file <a class="el" href="pcsed_8c_source.html">pcsed.c</a>.</p>

</div>
</div>
<a id="ac99e2e09777b69721e991ede780ea3fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac99e2e09777b69721e991ede780ea3fb">&#9670;&nbsp;</a></span>_eth_get_hwtype()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BYTE W32_CALL _eth_get_hwtype </td>
          <td>(</td>
          <td class="paramtype">BYTE *&#160;</td>
          <td class="paramname"><em>hwtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BYTE *&#160;</td>
          <td class="paramname"><em>hwlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill in hardware address type/length for BOOTP/DHCP packets. </p>
<p>Also used for ARP/RARP packets. Should never be called for PPP/SLIP. </p>

<p class="definition">Definition at line <a class="el" href="pcsed_8c_source.html#l00753">753</a> of file <a class="el" href="pcsed_8c_source.html">pcsed.c</a>.</p>

<p class="reference">References <a class="el" href="pcpkt_8c_source.html#l00048">_pktdevclass</a>.</p>

</div>
</div>
<a id="a9ebff273481692ad4e8f673521de12ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ebff273481692ad4e8f673521de12ba">&#9670;&nbsp;</a></span>_eth_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int W32_CALL _eth_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the network driver interface. </p>
<dl class="section return"><dt>Returns</dt><dd>0 okay. </dd>
<dd>
error-code otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="pcsed_8c_source.html#l00661">661</a> of file <a class="el" href="pcsed_8c_source.html">pcsed.c</a>.</p>

<p class="reference">References <a class="el" href="pcsed_8c_source.html#l00050">_eth_addr</a>, <a class="el" href="pcsed_8c_source.html#l00055">_eth_is_init</a>, <a class="el" href="pcsed_8c_source.html#l00053">_eth_real_addr</a>, <a class="el" href="pcpkt_8c_source.html#l00048">_pktdevclass</a>, <a class="el" href="pcsed_8c_source.html#l00457">eth_mac_format()</a>, <a class="el" href="pcsed_8c_source.html#l00101">mac_tx_format</a>, and <a class="el" href="pcpkt_8c_source.html#l01448">pkt_eth_init()</a>.</p>

</div>
</div>
<a id="a1aef6f9556ff4f2449be88a4e1e9e853"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1aef6f9556ff4f2449be88a4e1e9e853">&#9670;&nbsp;</a></span>_eth_join_mcast_group()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL _eth_join_mcast_group </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="struct_multi_cast.html">MultiCast</a> *&#160;</td>
          <td class="paramname"><em>mc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Joins a multicast group (at the physical layer). </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>The group was joined successfully. </td></tr>
    <tr><td class="paramname">0</td><td>Attempt failed. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pcsed_8c_source.html#l01246">1246</a> of file <a class="el" href="pcsed_8c_source.html">pcsed.c</a>.</p>

</div>
</div>
<a id="a237151e881e958bd4c2827e9fe03bb0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a237151e881e958bd4c2827e9fe03bb0d">&#9670;&nbsp;</a></span>_eth_leave_mcast_group()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL _eth_leave_mcast_group </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="struct_multi_cast.html">MultiCast</a> *&#160;</td>
          <td class="paramname"><em>mc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Leaves a multicast group (at the physical layer) </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>The group was left successfully. </td></tr>
    <tr><td class="paramname">0</td><td>Attempt failed. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pcsed_8c_source.html#l01322">1322</a> of file <a class="el" href="pcsed_8c_source.html">pcsed.c</a>.</p>

</div>
</div>
<a id="a7c1ce6ca70753560aa2020d04ef292ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c1ce6ca70753560aa2020d04ef292ce">&#9670;&nbsp;</a></span>_eth_recv_hook()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>* W32_CALL* _eth_recv_hook </td>
          <td>(</td>
          <td class="paramtype">WORD *&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Pointer to functions that when set changes the behaviour of polling and send functions <a class="el" href="pcsed_8c.html#ae158a0791f36d20f60aa9db52f48b147" title="Poll for arrival of new packets (IP/ARP/RARP/PPPoE protocol). ">_eth_arrived()</a> and <a class="el" href="pcsed_8c.html#a6ba624fcff27ce605d72837152781f84" title="_eth_send() does the actual transmission once we are complete with filling the buffer. ">_eth_send()</a>. </p>
<p>_eth_recv_hook: If set, must point to a function that supplies frames ready to be received. Return NULL if no frame is ready. Otherwise points to a raw MAC frame. If not a serial-driver, must also set '*type'.</p>
<p>_eth_recv_peek: If set, must point to a function that gets a chance to peek at the raw received frame. It can modify it or even consume it by returning zero. To prevent recursion, this function cannot call <a class="el" href="pctcp_8c.html#a5db19271d908ae67bcfebf2499c6a666" title="Must be called periodically by user application (or BSD socket API). ">tcp_tick()</a>. It should return as fast as possible in order not to block reception of other frames waiting in the receive buffer.</p>
<p>_eth_xmit_hook: If set, must point to a function that should transmit all frames generated by Watt-32. Must return length of frame sent or &lt;= 0 if it failed. </p>

</div>
</div>
<a id="a6ba624fcff27ce605d72837152781f84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ba624fcff27ce605d72837152781f84">&#9670;&nbsp;</a></span>_eth_send()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int W32_CALL _eth_send </td>
          <td>(</td>
          <td class="paramtype">WORD&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *&#160;</td>
          <td class="paramname"><em>sock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>line</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="pcsed_8c.html#a6ba624fcff27ce605d72837152781f84" title="_eth_send() does the actual transmission once we are complete with filling the buffer. ">_eth_send()</a> does the actual transmission once we are complete with filling the buffer. </p>
<p>Do any last minute patches here, like fix the size. Send to "loopback" device if it's IP and destination matches loopback network (127.x.x.x.).</p>
<p>Return length of network-layer packet (not length of link-layer packet). </p>

<p class="definition">Definition at line <a class="el" href="pcsed_8c_source.html#l00308">308</a> of file <a class="el" href="pcsed_8c_source.html">pcsed.c</a>.</p>

</div>
</div>
<a id="aa991e4288fdba0dca6be4ae3ac445912"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa991e4288fdba0dca6be4ae3ac445912">&#9670;&nbsp;</a></span>fix_llc_head()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> fix_llc_head </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> **&#160;</td>
          <td class="paramname"><em>mac</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000082">Todo:</a></b></dt><dd>handle IEEE 802.3 encapsulation also. </dd></dl>

<p class="definition">Definition at line <a class="el" href="pcsed_8c_source.html#l01002">1002</a> of file <a class="el" href="pcsed_8c_source.html">pcsed.c</a>.</p>

<p class="reference">References <a class="el" href="pcsed_8c_source.html#l00794">_eth_free()</a>.</p>

</div>
</div>
<a id="a6cfc2014559e0c222715da2a1f869e89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cfc2014559e0c222715da2a1f869e89">&#9670;&nbsp;</a></span>null_mac_format()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>* null_mac_format </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *&#160;</td>
          <td class="paramname"><em>mac_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *&#160;</td>
          <td class="paramname"><em>mac_dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">WORD&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Format MAC-header for protocols without MAC-headers. </p>
<p>Nothing done here. </p>

<p class="definition">Definition at line <a class="el" href="pcsed_8c_source.html#l00586">586</a> of file <a class="el" href="pcsed_8c_source.html">pcsed.c</a>.</p>

</div>
</div>
<a id="a56d7fe2ec0e9444b7492f32ccf8065ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56d7fe2ec0e9444b7492f32ccf8065ee">&#9670;&nbsp;</a></span>poll_recv_queue()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static union <a class="el" href="unionlink___packet.html">link_Packet</a>* poll_recv_queue </td>
          <td>(</td>
          <td class="paramtype">WORD *&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Poll the packet queue. </p>
<p>Return first packet in queue. Optionally do receiver profiling.</p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">pointer</td><td>to start of MAC-header. </td></tr>
    <tr><td class="paramname">NULL</td><td>no packets are queued.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Not used when e.g. libpcap has set the `_eth_recv_hook' to do it's own packet-polling. </dd>
<dd>
'type' is always set. </dd></dl>

<p class="definition">Definition at line <a class="el" href="pcsed_8c_source.html#l00897">897</a> of file <a class="el" href="pcsed_8c_source.html">pcsed.c</a>.</p>

<p class="reference">References <a class="el" href="pcpkt_8c_source.html#l00061">_pkt_inf</a>.</p>

</div>
</div>
<a id="adf475c1f22283fe7fd921faf88c81715"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf475c1f22283fe7fd921faf88c81715">&#9670;&nbsp;</a></span>send_loopback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int send_loopback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="unionlink___packet.html">link_Packet</a>&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BOOL&#160;</td>
          <td class="paramname"><em>is_ip6</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname"><em>err_line</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enqueue a link-layer frame (IPv4/v6 only) to the internal loopback device. </p>
<dl class="section note"><dt>Note</dt><dd>This function uses call-by-value. Thus `pkt' buffer can be modified by loopback_device() and loopback handler may send using <a class="el" href="pcsed_8c.html#a6ba624fcff27ce605d72837152781f84" title="_eth_send() does the actual transmission once we are complete with filling the buffer. ">_eth_send()</a>.</dd>
<dd>
Loopback device cannot send to itself (potential recursion). </dd></dl>

<p class="definition">Definition at line <a class="el" href="pcsed_8c_source.html#l00156">156</a> of file <a class="el" href="pcsed_8c_source.html">pcsed.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ade90d948435190c456ade74139f19df4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade90d948435190c456ade74139f19df4">&#9670;&nbsp;</a></span>mac_tx_format</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>*(* mac_tx_format) (<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *mac_buf, const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *mac_dest, WORD type)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to functions that does the filling of correct MAC-header and sends the link-layer packet. </p>
<p>We store 'proto' between calls. </p>

<p class="definition">Definition at line <a class="el" href="pcsed_8c_source.html#l00101">101</a> of file <a class="el" href="pcsed_8c_source.html">pcsed.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_43e0a1f539e00dcfa1a6bc4d4fee4fc2.html">home</a></li><li class="navelem"><a class="el" href="dir_ab8596c82667c0aca9997b52c5dbee43.html">fosco</a></li><li class="navelem"><a class="el" href="dir_080421ebeac7d91b01d16c10e3428daa.html">src</a></li><li class="navelem"><a class="el" href="dir_6df265bdd26cb50194bab3fa12ccd5e5.html">SSH2DOS</a></li><li class="navelem"><a class="el" href="dir_b1c9b88edcbbea5952d2cf10cb584ddc.html">watt32</a></li><li class="navelem"><a class="el" href="dir_7ffa6a371f53fb7b9b5c8573af96f924.html">src</a></li><li class="navelem"><a class="el" href="pcsed_8c.html">pcsed.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
