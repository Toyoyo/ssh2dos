<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Watt-32 tcp/ip: /home/fosco/src/SSH2DOS/watt32/src/pcarp.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Watt-32 tcp/ip
   &#160;<span id="projectnumber">2.2 dev-rel.10</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('pcarp_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">pcarp.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="pcarp_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6b276e72c8a4ab609ac9853af6365323"><td class="memItemLeft" align="right" valign="top"><a id="a6b276e72c8a4ab609ac9853af6365323"></a>
static const char *&#160;</td><td class="memItemRight" valign="bottom"><b>get_ARP_flags</b> (WORD flg)</td></tr>
<tr class="separator:a6b276e72c8a4ab609ac9853af6365323"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ba940142a9bf43252372e13e604ed64"><td class="memItemLeft" align="right" valign="top"><a id="a6ba940142a9bf43252372e13e604ed64"></a>
static const char *&#160;</td><td class="memItemRight" valign="bottom"><b>get_route_flags</b> (WORD flg)</td></tr>
<tr class="separator:a6ba940142a9bf43252372e13e604ed64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2157d6853151eb46f820a126401e9b37"><td class="memItemLeft" align="right" valign="top"><a id="a2157d6853151eb46f820a126401e9b37"></a>
static BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a2157d6853151eb46f820a126401e9b37">LAN_lookup</a> (DWORD ip, eth_address *eth)</td></tr>
<tr class="memdesc:a2157d6853151eb46f820a126401e9b37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lookup host in fixed/dynamic list. <br /></td></tr>
<tr class="separator:a2157d6853151eb46f820a126401e9b37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d530e0dc1d55ee68105820f2b6efdee"><td class="memItemLeft" align="right" valign="top"><a id="a1d530e0dc1d55ee68105820f2b6efdee"></a>
static BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a1d530e0dc1d55ee68105820f2b6efdee">is_on_LAN</a> (DWORD ip)</td></tr>
<tr class="memdesc:a1d530e0dc1d55ee68105820f2b6efdee"><td class="mdescLeft">&#160;</td><td class="mdescRight">This should probably go into route.c. <br /></td></tr>
<tr class="separator:a1d530e0dc1d55ee68105820f2b6efdee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71267dec3a49e7f3c2c9ad84fe433a6e"><td class="memItemLeft" align="right" valign="top"><a id="a71267dec3a49e7f3c2c9ad84fe433a6e"></a>
static BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a71267dec3a49e7f3c2c9ad84fe433a6e">arp_check_common</a> (DWORD ip, eth_address *eth)</td></tr>
<tr class="memdesc:a71267dec3a49e7f3c2c9ad84fe433a6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Common stuff for <a class="el" href="pcarp_8c.html#a0e2f27f4017f14684ebd09ef3c676eaa" title="The blocking lookup function visible to higher functions. ">_arp_resolve()</a> and <a class="el" href="pcarp_8c.html#a690846ce84ecbad4d282c03d32227104" title="Lookup MAC-address of &#39;ip&#39;. ">_arp_lookup()</a> <br /></td></tr>
<tr class="separator:a71267dec3a49e7f3c2c9ad84fe433a6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f73b891b4481f0b3d6a38f5dcbfbce2"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a4f73b891b4481f0b3d6a38f5dcbfbce2">arp_daemon</a> (<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>)</td></tr>
<tr class="memdesc:a4f73b891b4481f0b3d6a38f5dcbfbce2"><td class="mdescLeft">&#160;</td><td class="mdescRight">ARP background daemon.  <a href="#a4f73b891b4481f0b3d6a38f5dcbfbce2">More...</a><br /></td></tr>
<tr class="separator:a4f73b891b4481f0b3d6a38f5dcbfbce2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f3fc9371e9f9d67f54cd1939c4cd81b"><td class="memItemLeft" align="right" valign="top">int W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a8f3fc9371e9f9d67f54cd1939c4cd81b">_arp_gateways_get</a> (const struct <a class="el" href="structgate__entry.html">gate_entry</a> **rc)</td></tr>
<tr class="memdesc:a8f3fc9371e9f9d67f54cd1939c4cd81b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return start of gate_list[].  <a href="#a8f3fc9371e9f9d67f54cd1939c4cd81b">More...</a><br /></td></tr>
<tr class="separator:a8f3fc9371e9f9d67f54cd1939c4cd81b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a875639b7074e6a0fb67f0491d475c3af"><td class="memItemLeft" align="right" valign="top"><a id="a875639b7074e6a0fb67f0491d475c3af"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>ping_gateway</b> (DWORD host, <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *eth)</td></tr>
<tr class="separator:a875639b7074e6a0fb67f0491d475c3af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cff96c11064707853eb3c6b1c360c79"><td class="memItemLeft" align="right" valign="top"><a id="a5cff96c11064707853eb3c6b1c360c79"></a>
static <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><b>check_dead_gw</b> (<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>)</td></tr>
<tr class="separator:a5cff96c11064707853eb3c6b1c360c79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73ac2144d4b71e107c8198ea909d276e"><td class="memItemLeft" align="right" valign="top"><a id="a73ac2144d4b71e107c8198ea909d276e"></a>
static BOOL&#160;</td><td class="memItemRight" valign="bottom"><b>legal_mask</b> (DWORD mask, DWORD addr)</td></tr>
<tr class="separator:a73ac2144d4b71e107c8198ea909d276e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47b5f2ce894307e1bd4d4bc54526660d"><td class="memItemLeft" align="right" valign="top">static int MS_CDECL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a47b5f2ce894307e1bd4d4bc54526660d">compare</a> (const struct <a class="el" href="structgate__entry.html">gate_entry</a> *a, const struct <a class="el" href="structgate__entry.html">gate_entry</a> *b)</td></tr>
<tr class="memdesc:a47b5f2ce894307e1bd4d4bc54526660d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compare two entries in gateway-list.  <a href="#a47b5f2ce894307e1bd4d4bc54526660d">More...</a><br /></td></tr>
<tr class="separator:a47b5f2ce894307e1bd4d4bc54526660d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10372541d03788669686e91b4ba03f1c"><td class="memItemLeft" align="right" valign="top">BOOL W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a10372541d03788669686e91b4ba03f1c">_arp_add_gateway</a> (const char *config_string, DWORD ip)</td></tr>
<tr class="memdesc:a10372541d03788669686e91b4ba03f1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a gateway to the routing table.  <a href="#a10372541d03788669686e91b4ba03f1c">More...</a><br /></td></tr>
<tr class="separator:a10372541d03788669686e91b4ba03f1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2511c6a9ba4f985cdef6a3f5a447af32"><td class="memItemLeft" align="right" valign="top"><a id="a2511c6a9ba4f985cdef6a3f5a447af32"></a>
<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a2511c6a9ba4f985cdef6a3f5a447af32">_arp_kill_gateways</a> (<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>)</td></tr>
<tr class="memdesc:a2511c6a9ba4f985cdef6a3f5a447af32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete all gateways. <br /></td></tr>
<tr class="separator:a2511c6a9ba4f985cdef6a3f5a447af32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ec93008680cc53bb134e95872af8dc9"><td class="memItemLeft" align="right" valign="top"><a id="a3ec93008680cc53bb134e95872af8dc9"></a>
BOOL W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a3ec93008680cc53bb134e95872af8dc9">_arp_have_default_gw</a> (<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>)</td></tr>
<tr class="memdesc:a3ec93008680cc53bb134e95872af8dc9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if we have at least one default gateway. <br /></td></tr>
<tr class="separator:a3ec93008680cc53bb134e95872af8dc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e18fc7bfe176cd5996166be70d7a234"><td class="memItemLeft" align="right" valign="top"><a id="a6e18fc7bfe176cd5996166be70d7a234"></a>
static BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a6e18fc7bfe176cd5996166be70d7a234">arp_send</a> (const <a class="el" href="structarp___header.html">arp_Header</a> *<a class="el" href="structarp.html">arp</a>, unsigned line)</td></tr>
<tr class="memdesc:a6e18fc7bfe176cd5996166be70d7a234"><td class="mdescLeft">&#160;</td><td class="mdescRight">Low-level ARP send function. <br /></td></tr>
<tr class="separator:a6e18fc7bfe176cd5996166be70d7a234"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a528b4924a247158cb5a9b8729a3bdaaa"><td class="memItemLeft" align="right" valign="top"><a id="a528b4924a247158cb5a9b8729a3bdaaa"></a>
static BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a528b4924a247158cb5a9b8729a3bdaaa">arp_send_request</a> (DWORD ip)</td></tr>
<tr class="memdesc:a528b4924a247158cb5a9b8729a3bdaaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send broadcast ARP request. <br /></td></tr>
<tr class="separator:a528b4924a247158cb5a9b8729a3bdaaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba91f5a188640036fc2b32b835c932af"><td class="memItemLeft" align="right" valign="top">BOOL W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#aba91f5a188640036fc2b32b835c932af">_arp_reply</a> (const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *e_dst, DWORD src_ip, DWORD dst_ip)</td></tr>
<tr class="memdesc:aba91f5a188640036fc2b32b835c932af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send unicast/broadcast ARP reply.  <a href="#aba91f5a188640036fc2b32b835c932af">More...</a><br /></td></tr>
<tr class="separator:aba91f5a188640036fc2b32b835c932af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae26631bfde3f1c6666bf929c3d4ace1f"><td class="memItemLeft" align="right" valign="top"><a id="ae26631bfde3f1c6666bf929c3d4ace1f"></a>
static <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#ae26631bfde3f1c6666bf929c3d4ace1f">arp_move_entry</a> (int to_index, int from_index)</td></tr>
<tr class="memdesc:ae26631bfde3f1c6666bf929c3d4ace1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Move an ARP entry from <b>from_index</b> to <b>to_index</b>. <br /></td></tr>
<tr class="separator:ae26631bfde3f1c6666bf929c3d4ace1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaed2e284b319712d3f73e31653aa8f63"><td class="memItemLeft" align="right" valign="top">int W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#aaed2e284b319712d3f73e31653aa8f63">_arp_cache_get</a> (const struct <a class="el" href="structarp__entry.html">arp_entry</a> **rc)</td></tr>
<tr class="memdesc:aaed2e284b319712d3f73e31653aa8f63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return start of arp_list[].  <a href="#aaed2e284b319712d3f73e31653aa8f63">More...</a><br /></td></tr>
<tr class="separator:aaed2e284b319712d3f73e31653aa8f63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5964e28bfa3e03f2a2d6d38b6e92ddb0"><td class="memItemLeft" align="right" valign="top">static BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a5964e28bfa3e03f2a2d6d38b6e92ddb0">LAN_start_lookup</a> (DWORD ip)</td></tr>
<tr class="memdesc:a5964e28bfa3e03f2a2d6d38b6e92ddb0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start a host lookup on the LAN.  <a href="#a5964e28bfa3e03f2a2d6d38b6e92ddb0">More...</a><br /></td></tr>
<tr class="separator:a5964e28bfa3e03f2a2d6d38b6e92ddb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06e84d00235fccc572fc46a5f70c2db6"><td class="memItemLeft" align="right" valign="top"><a id="a06e84d00235fccc572fc46a5f70c2db6"></a>
static BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a06e84d00235fccc572fc46a5f70c2db6">LAN_lookup_pending</a> (DWORD ip)</td></tr>
<tr class="memdesc:a06e84d00235fccc572fc46a5f70c2db6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lookup host in pending list. <br /></td></tr>
<tr class="separator:a06e84d00235fccc572fc46a5f70c2db6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae128add6dce4cf2affb8e076dbea190d"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#ae128add6dce4cf2affb8e076dbea190d">arp_check_timeouts</a> (BOOL check_dynamic_entries)</td></tr>
<tr class="memdesc:ae128add6dce4cf2affb8e076dbea190d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check ARP entries for timeout.  <a href="#ae128add6dce4cf2affb8e076dbea190d">More...</a><br /></td></tr>
<tr class="separator:ae128add6dce4cf2affb8e076dbea190d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae92a8e8abc2c376e6e2739d8497604b2"><td class="memItemLeft" align="right" valign="top"><a id="ae92a8e8abc2c376e6e2739d8497604b2"></a>
static <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><b>route_move_entry</b> (int to_index, int from_index)</td></tr>
<tr class="separator:ae92a8e8abc2c376e6e2739d8497604b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87ba77327757cbbd56ae550c777d09db"><td class="memItemLeft" align="right" valign="top"><a id="a87ba77327757cbbd56ae550c777d09db"></a>
static BOOL&#160;</td><td class="memItemRight" valign="bottom"><b>route_make_new_slot</b> (DWORD host_ip, DWORD gate_ip, DWORD mask)</td></tr>
<tr class="separator:a87ba77327757cbbd56ae550c777d09db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3b9cb9de75d252c8b08401b298a3b9f"><td class="memItemLeft" align="right" valign="top">BOOL W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#ae3b9cb9de75d252c8b08401b298a3b9f">_arp_register</a> (DWORD use_this_gateway_ip, DWORD for_this_host_ip)</td></tr>
<tr class="memdesc:ae3b9cb9de75d252c8b08401b298a3b9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a new host as gateway.  <a href="#ae3b9cb9de75d252c8b08401b298a3b9f">More...</a><br /></td></tr>
<tr class="separator:ae3b9cb9de75d252c8b08401b298a3b9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a928142c8c7a05b4d8f2c6d8bf40842ef"><td class="memItemLeft" align="right" valign="top"><a id="a928142c8c7a05b4d8f2c6d8bf40842ef"></a>
static BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a928142c8c7a05b4d8f2c6d8bf40842ef">route_lookup</a> (DWORD ip, eth_address *eth)</td></tr>
<tr class="memdesc:a928142c8c7a05b4d8f2c6d8bf40842ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets MAC of gateway needed to reach the given host. <br /></td></tr>
<tr class="separator:a928142c8c7a05b4d8f2c6d8bf40842ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a7f031d30f2c40f9634fa3f0c71dfc5"><td class="memItemLeft" align="right" valign="top"><a id="a1a7f031d30f2c40f9634fa3f0c71dfc5"></a>
static BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a1a7f031d30f2c40f9634fa3f0c71dfc5">route_lookup_pending</a> (DWORD ip)</td></tr>
<tr class="memdesc:a1a7f031d30f2c40f9634fa3f0c71dfc5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns TRUE if the lookup of the gateway (assigned to the supplied ip) is still pending. <br /></td></tr>
<tr class="separator:a1a7f031d30f2c40f9634fa3f0c71dfc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a891f4d6fa65667490250c468367855"><td class="memItemLeft" align="right" valign="top"><a id="a4a891f4d6fa65667490250c468367855"></a>
static BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a4a891f4d6fa65667490250c468367855">route_start_lookup</a> (DWORD ip)</td></tr>
<tr class="memdesc:a4a891f4d6fa65667490250c468367855"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start a route lookup. <br /></td></tr>
<tr class="separator:a4a891f4d6fa65667490250c468367855"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad50c8a75c1ad7c66322416ce66b39792"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#ad50c8a75c1ad7c66322416ce66b39792">route_check_timeouts</a> (BOOL check_dynamic_entries)</td></tr>
<tr class="memdesc:ad50c8a75c1ad7c66322416ce66b39792"><td class="mdescLeft">&#160;</td><td class="mdescRight">Periodic route checker.  <a href="#ad50c8a75c1ad7c66322416ce66b39792">More...</a><br /></td></tr>
<tr class="separator:ad50c8a75c1ad7c66322416ce66b39792"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9153c34822a2449a56dc633429dea4d"><td class="memItemLeft" align="right" valign="top">BOOL W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#af9153c34822a2449a56dc633429dea4d">_arp_start_lookup</a> (DWORD ip)</td></tr>
<tr class="memdesc:af9153c34822a2449a56dc633429dea4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">"PUBLIC" ARP/ROUTE FUNCTIONS.  <a href="#af9153c34822a2449a56dc633429dea4d">More...</a><br /></td></tr>
<tr class="separator:af9153c34822a2449a56dc633429dea4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a690846ce84ecbad4d282c03d32227104"><td class="memItemLeft" align="right" valign="top">BOOL W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a690846ce84ecbad4d282c03d32227104">_arp_lookup</a> (DWORD ip, eth_address *eth)</td></tr>
<tr class="memdesc:a690846ce84ecbad4d282c03d32227104"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lookup MAC-address of 'ip'.  <a href="#a690846ce84ecbad4d282c03d32227104">More...</a><br /></td></tr>
<tr class="separator:a690846ce84ecbad4d282c03d32227104"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5f03b2dc0675fae4f0ce8950db573d1"><td class="memItemLeft" align="right" valign="top">BOOL W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#ac5f03b2dc0675fae4f0ce8950db573d1">_arp_lookup_pending</a> (DWORD ip)</td></tr>
<tr class="memdesc:ac5f03b2dc0675fae4f0ce8950db573d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">An ARP-lookup timeout check.  <a href="#ac5f03b2dc0675fae4f0ce8950db573d1">More...</a><br /></td></tr>
<tr class="separator:ac5f03b2dc0675fae4f0ce8950db573d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f88f6a50d3603359426d0b290af2492"><td class="memItemLeft" align="right" valign="top">BOOL W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a3f88f6a50d3603359426d0b290af2492">_arp_lookup_fixed</a> (DWORD ip, eth_address *eth)</td></tr>
<tr class="memdesc:a3f88f6a50d3603359426d0b290af2492"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lookup fixed MAC-address of 'ip'.  <a href="#a3f88f6a50d3603359426d0b290af2492">More...</a><br /></td></tr>
<tr class="separator:a3f88f6a50d3603359426d0b290af2492"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e2f27f4017f14684ebd09ef3c676eaa"><td class="memItemLeft" align="right" valign="top">BOOL W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a0e2f27f4017f14684ebd09ef3c676eaa">_arp_resolve</a> (DWORD ip, eth_address *eth)</td></tr>
<tr class="memdesc:a0e2f27f4017f14684ebd09ef3c676eaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">The blocking lookup function visible to higher functions.  <a href="#a0e2f27f4017f14684ebd09ef3c676eaa">More...</a><br /></td></tr>
<tr class="separator:a0e2f27f4017f14684ebd09ef3c676eaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38268ed64dd415b34c7578124e474623"><td class="memItemLeft" align="right" valign="top">BOOL W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a38268ed64dd415b34c7578124e474623">_arp_cache_add</a> (DWORD ip, const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *eth, BOOL expires)</td></tr>
<tr class="memdesc:a38268ed64dd415b34c7578124e474623"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add given IP/Ether address to ARP-cache.  <a href="#a38268ed64dd415b34c7578124e474623">More...</a><br /></td></tr>
<tr class="separator:a38268ed64dd415b34c7578124e474623"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9121fc348127046e63b24e2901b72882"><td class="memItemLeft" align="right" valign="top">BOOL W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a9121fc348127046e63b24e2901b72882">_arp_cache_del</a> (DWORD ip)</td></tr>
<tr class="memdesc:a9121fc348127046e63b24e2901b72882"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delete given 'ip' address from ARP-cache (dynamic, fixed or pending).  <a href="#a9121fc348127046e63b24e2901b72882">More...</a><br /></td></tr>
<tr class="separator:a9121fc348127046e63b24e2901b72882"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75ecd1824b8a95e109ff185fdee39eeb"><td class="memItemLeft" align="right" valign="top"><a id="a75ecd1824b8a95e109ff185fdee39eeb"></a>
static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a75ecd1824b8a95e109ff185fdee39eeb">void</a> (W32_CALL *prev_cfg_hook)(const char *</td></tr>
<tr class="memdesc:a75ecd1824b8a95e109ff185fdee39eeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parser for "\c ARP.xx" keywords in "\c WATTCP.CFG". <br /></td></tr>
<tr class="separator:a75ecd1824b8a95e109ff185fdee39eeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a886e992be444ce16d07370ce898bec0a"><td class="memItemLeft" align="right" valign="top"><a id="a886e992be444ce16d07370ce898bec0a"></a>
static const char *static <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><b>arp_parse</b> (const char *name, const char *value)</td></tr>
<tr class="separator:a886e992be444ce16d07370ce898bec0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a793041037e149338bf62932b764c40bb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a793041037e149338bf62932b764c40bb">_arp_init</a> (<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>)</td></tr>
<tr class="memdesc:a793041037e149338bf62932b764c40bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup config-table parse function and add background ARP deamon.  <a href="#a793041037e149338bf62932b764c40bb">More...</a><br /></td></tr>
<tr class="separator:a793041037e149338bf62932b764c40bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4f254e7477196929e3ff7a0faa51f6a"><td class="memItemLeft" align="right" valign="top">BOOL W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#aa4f254e7477196929e3ff7a0faa51f6a">_arp_handler</a> (const <a class="el" href="structarp___header.html">arp_Header</a> *<a class="el" href="structah.html">ah</a>, BOOL brdcast)</td></tr>
<tr class="memdesc:aa4f254e7477196929e3ff7a0faa51f6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive ARP handler.  <a href="#aa4f254e7477196929e3ff7a0faa51f6a">More...</a><br /></td></tr>
<tr class="separator:aa4f254e7477196929e3ff7a0faa51f6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca88979901ae3d89d3de5d546ae9c1d1"><td class="memItemLeft" align="right" valign="top">BOOL W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#aca88979901ae3d89d3de5d546ae9c1d1">_arp_check_own_ip</a> (eth_address *other_guy)</td></tr>
<tr class="memdesc:aca88979901ae3d89d3de5d546ae9c1d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used by DHCP initialisation.  <a href="#aca88979901ae3d89d3de5d546ae9c1d1">More...</a><br /></td></tr>
<tr class="separator:aca88979901ae3d89d3de5d546ae9c1d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6c90dddd70fd1daf0afdbea026e3398"><td class="memItemLeft" align="right" valign="top"><a id="ac6c90dddd70fd1daf0afdbea026e3398"></a>
int W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#ac6c90dddd70fd1daf0afdbea026e3398">_arp_check_gateways</a> (<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>)</td></tr>
<tr class="memdesc:ac6c90dddd70fd1daf0afdbea026e3398"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return number of default gateways. <br /></td></tr>
<tr class="separator:ac6c90dddd70fd1daf0afdbea026e3398"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40e2121d46ef4239f42b626266bd6a1c"><td class="memItemLeft" align="right" valign="top"><a id="a40e2121d46ef4239f42b626266bd6a1c"></a>
<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><b>_arp_cache_dump</b> (<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>)</td></tr>
<tr class="separator:a40e2121d46ef4239f42b626266bd6a1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01ad301afb4f379ba0db38c4631cd798"><td class="memItemLeft" align="right" valign="top"><a id="a01ad301afb4f379ba0db38c4631cd798"></a>
<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><b>_arp_routes_dump</b> (<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>)</td></tr>
<tr class="separator:a01ad301afb4f379ba0db38c4631cd798"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5a7b9fbde444f0d640b0e27821322ab"><td class="memItemLeft" align="right" valign="top"><a id="ac5a7b9fbde444f0d640b0e27821322ab"></a>
<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><b>_arp_gateways_dump</b> (<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>)</td></tr>
<tr class="separator:ac5a7b9fbde444f0d640b0e27821322ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82c9fdc90a238736f7f18d0ceb56a5fb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> W32_CALL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#a82c9fdc90a238736f7f18d0ceb56a5fb">_arp_debug_dump</a> (<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>)</td></tr>
<tr class="memdesc:a82c9fdc90a238736f7f18d0ceb56a5fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Debug-dump of configured gateways, route table and ARP cache.  <a href="#a82c9fdc90a238736f7f18d0ceb56a5fb">More...</a><br /></td></tr>
<tr class="separator:a82c9fdc90a238736f7f18d0ceb56a5fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a3e93368019655ae7ef28c879de662f"><td class="memItemLeft" align="right" valign="top"><a id="a5a3e93368019655ae7ef28c879de662f"></a>
DWORD&#160;</td><td class="memItemRight" valign="bottom"><b>_route_destin</b> (DWORD ip)</td></tr>
<tr class="separator:a5a3e93368019655ae7ef28c879de662f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4c1387e61a2b2a66e0a73b29b9e4df1"><td class="memItemLeft" align="right" valign="top"><a id="ac4c1387e61a2b2a66e0a73b29b9e4df1"></a>
static <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>&#160;</td><td class="memItemRight" valign="bottom"><b>callback</b> (<a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>)</td></tr>
<tr class="separator:ac4c1387e61a2b2a66e0a73b29b9e4df1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top"><a id="a3c04138a5bfe5d72780bb7e82a18e627"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>main</b> (int argc, char **argv)</td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a6aeaa930fb4763045af345a414b97985"><td class="memItemLeft" align="right" valign="top"><a id="a6aeaa930fb4763045af345a414b97985"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>arp_trace_level</b> = 0</td></tr>
<tr class="separator:a6aeaa930fb4763045af345a414b97985"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a299c582868aeb1c141522f9b8f436f92"><td class="memItemLeft" align="right" valign="top"><a id="a299c582868aeb1c141522f9b8f436f92"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>arp_timeout</b> = 2</td></tr>
<tr class="separator:a299c582868aeb1c141522f9b8f436f92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a288cac6b4ff69fe1f65efa9d956f3c95"><td class="memItemLeft" align="right" valign="top"><a id="a288cac6b4ff69fe1f65efa9d956f3c95"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>arp_alive</b> = 300</td></tr>
<tr class="separator:a288cac6b4ff69fe1f65efa9d956f3c95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1568b3cc0a4253d9b855a492e848c2d6"><td class="memItemLeft" align="right" valign="top"><a id="a1568b3cc0a4253d9b855a492e848c2d6"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>arp_rexmit_to</b> = 250</td></tr>
<tr class="separator:a1568b3cc0a4253d9b855a492e848c2d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0913001fe59017dcc81a1964aaec3fb"><td class="memItemLeft" align="right" valign="top"><a id="af0913001fe59017dcc81a1964aaec3fb"></a>
static BOOL&#160;</td><td class="memItemRight" valign="bottom"><b>dead_gw_detect</b> = FALSE</td></tr>
<tr class="separator:af0913001fe59017dcc81a1964aaec3fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9566f8a0c3a8ad3cb7820d2104eb8a42"><td class="memItemLeft" align="right" valign="top"><a id="a9566f8a0c3a8ad3cb7820d2104eb8a42"></a>
static BOOL&#160;</td><td class="memItemRight" valign="bottom"><b>arp_gratiotous</b> = FALSE</td></tr>
<tr class="separator:a9566f8a0c3a8ad3cb7820d2104eb8a42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4857d434cef440858afc4e694d1578e0"><td class="memItemLeft" align="right" valign="top"><a id="a4857d434cef440858afc4e694d1578e0"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>gate_top</b> = 0</td></tr>
<tr class="separator:a4857d434cef440858afc4e694d1578e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac66c19ded8f337db24a898322ebc53b4"><td class="memItemLeft" align="right" valign="top"><a id="ac66c19ded8f337db24a898322ebc53b4"></a>
static struct <a class="el" href="structgate__entry.html">gate_entry</a>&#160;</td><td class="memItemRight" valign="bottom"><b>gate_list</b> [GATE_TOP_OF_CACHE]</td></tr>
<tr class="separator:ac66c19ded8f337db24a898322ebc53b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5bb737f6a75f0122c26443f2fae4725"><td class="memItemLeft" align="right" valign="top">static WORD&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pcarp_8c.html#ab5bb737f6a75f0122c26443f2fae4725">icmp_id</a> = 0</td></tr>
<tr class="memdesc:ab5bb737f6a75f0122c26443f2fae4725"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send a ping (with TTL=1) to a gateway.  <a href="#ab5bb737f6a75f0122c26443f2fae4725">More...</a><br /></td></tr>
<tr class="separator:ab5bb737f6a75f0122c26443f2fae4725"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa47d98d66ec12987a295a71d7e8fe22e"><td class="memItemLeft" align="right" valign="top"><a id="aa47d98d66ec12987a295a71d7e8fe22e"></a>
static WORD&#160;</td><td class="memItemRight" valign="bottom"><b>icmp_seq</b> = 0</td></tr>
<tr class="separator:aa47d98d66ec12987a295a71d7e8fe22e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f60e170c6e6bb2e12a839ef1fd8f384"><td class="memItemLeft" align="right" valign="top"><a id="a4f60e170c6e6bb2e12a839ef1fd8f384"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>arp_first_pending</b> = ARP_TOP_PENDING</td></tr>
<tr class="separator:a4f60e170c6e6bb2e12a839ef1fd8f384"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc34d96f66e5074dbc913e5072b7b8bd"><td class="memItemLeft" align="right" valign="top"><a id="adc34d96f66e5074dbc913e5072b7b8bd"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>arp_first_free</b> = 0</td></tr>
<tr class="separator:adc34d96f66e5074dbc913e5072b7b8bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b6c3557ed998ea00b5ed2dfd577c622"><td class="memItemLeft" align="right" valign="top"><a id="a5b6c3557ed998ea00b5ed2dfd577c622"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>arp_first_dynamic</b> = 0</td></tr>
<tr class="separator:a5b6c3557ed998ea00b5ed2dfd577c622"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0eeca31f76d85a9379cc515026c07f0"><td class="memItemLeft" align="right" valign="top"><a id="ac0eeca31f76d85a9379cc515026c07f0"></a>
static struct <a class="el" href="structarp__entry.html">arp_entry</a>&#160;</td><td class="memItemRight" valign="bottom"><b>arp_list</b> [ARP_TOP_OF_CACHE]</td></tr>
<tr class="separator:ac0eeca31f76d85a9379cc515026c07f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a747febcbf1f98ab6bbbb09bff3db06f3"><td class="memItemLeft" align="right" valign="top"><a id="a747febcbf1f98ab6bbbb09bff3db06f3"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>route_first_pending</b> = ROUTE_TOP_PENDING</td></tr>
<tr class="separator:a747febcbf1f98ab6bbbb09bff3db06f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8c9694e15875d3d67345468994b48b5"><td class="memItemLeft" align="right" valign="top"><a id="ad8c9694e15875d3d67345468994b48b5"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>route_first_free</b> = 0</td></tr>
<tr class="separator:ad8c9694e15875d3d67345468994b48b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36ffc34c56d3c9c1c165df0ac564f9e7"><td class="memItemLeft" align="right" valign="top"><a id="a36ffc34c56d3c9c1c165df0ac564f9e7"></a>
static struct <a class="el" href="structroute__entry.html">route_entry</a>&#160;</td><td class="memItemRight" valign="bottom"><b>route_list</b> [ROUTE_TOP_OF_CACHE]</td></tr>
<tr class="separator:a36ffc34c56d3c9c1c165df0ac564f9e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af219e0ee64aeeff015b4fdbf96a1696e"><td class="memItemLeft" align="right" valign="top"><a id="af219e0ee64aeeff015b4fdbf96a1696e"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>num_okay</b> = 0</td></tr>
<tr class="separator:af219e0ee64aeeff015b4fdbf96a1696e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77b6a83783854dd46e9305d62224431b"><td class="memItemLeft" align="right" valign="top"><a id="a77b6a83783854dd46e9305d62224431b"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>num_fail</b> = 0</td></tr>
<tr class="separator:a77b6a83783854dd46e9305d62224431b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Address Resolution Protocol.</p>
<p>2002-09 Gundolf von Bachhaus: 90% rewrite - Optional non-blocking ARP lookup &amp; redirect handling Gateway / Route / ARP data stored &amp; accessed separately Module encapsulated - no global variables. </p>

<p class="definition">Definition in file <a class="el" href="pcarp_8c_source.html">pcarp.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a10372541d03788669686e91b4ba03f1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10372541d03788669686e91b4ba03f1c">&#9670;&nbsp;</a></span>_arp_add_gateway()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL W32_CALL _arp_add_gateway </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>config_string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DWORD&#160;</td>
          <td class="paramname"><em>ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a gateway to the routing table. </p>
<p>The format of 'config_string' is: gateway [,subnet], mask]]</p>
<p>If 'config_string' is NULL, simply add 'ip' with zero mask and subnet.</p>
<p>eg. "gateway = 129.97.176.1" -&gt; becomes the default route eg. "gateway = 129.97.176.2, 129.97.0.0, 255.255.0.0"</p>
<p>The first example shows how a default gateway is created. A default gateway is used if no other choices exist.</p>
<p>The second example shows how to specify a gateway for a particular subnet. In this example, whenever the 'top' 16 bits of the destination are 129.97.*.*, that gateway will be used.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000049">Todo:</a></b></dt><dd>Move to route.c and rename to route_add(). </dd></dl>

<p class="definition">Definition at line <a class="el" href="pcarp_8c_source.html#l00248">248</a> of file <a class="el" href="pcarp_8c_source.html">pcarp.c</a>.</p>

</div>
</div>
<a id="a38268ed64dd415b34c7578124e474623"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38268ed64dd415b34c7578124e474623">&#9670;&nbsp;</a></span>_arp_cache_add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL W32_CALL _arp_cache_add </td>
          <td>(</td>
          <td class="paramtype">DWORD&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *&#160;</td>
          <td class="paramname"><em>eth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BOOL&#160;</td>
          <td class="paramname"><em>expires</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add given IP/Ether address to ARP-cache. </p>
<p>ARP cache functions.</p>
<dl class="section note"><dt>Note</dt><dd>'ip' is on host order. </dd></dl>

<p class="definition">Definition at line <a class="el" href="pcarp_8c_source.html#l01353">1353</a> of file <a class="el" href="pcarp_8c_source.html">pcarp.c</a>.</p>

</div>
</div>
<a id="a9121fc348127046e63b24e2901b72882"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9121fc348127046e63b24e2901b72882">&#9670;&nbsp;</a></span>_arp_cache_del()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL W32_CALL _arp_cache_del </td>
          <td>(</td>
          <td class="paramtype">DWORD&#160;</td>
          <td class="paramname"><em>ip</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delete given 'ip' address from ARP-cache (dynamic, fixed or pending). </p>
<dl class="section note"><dt>Note</dt><dd>'ip' is on host order. </dd></dl>

<p class="definition">Definition at line <a class="el" href="pcarp_8c_source.html#l01422">1422</a> of file <a class="el" href="pcarp_8c_source.html">pcarp.c</a>.</p>

</div>
</div>
<a id="aaed2e284b319712d3f73e31653aa8f63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaed2e284b319712d3f73e31653aa8f63">&#9670;&nbsp;</a></span>_arp_cache_get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int W32_CALL _arp_cache_get </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structarp__entry.html">arp_entry</a> **&#160;</td>
          <td class="paramname"><em>rc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return start of arp_list[]. </p>
<dl class="section note"><dt>Note</dt><dd>Called need to inspect the '*rc-&gt;flags' for validity. </dd></dl>

<p class="definition">Definition at line <a class="el" href="pcarp_8c_source.html#l00528">528</a> of file <a class="el" href="pcarp_8c_source.html">pcarp.c</a>.</p>

</div>
</div>
<a id="aca88979901ae3d89d3de5d546ae9c1d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca88979901ae3d89d3de5d546ae9c1d1">&#9670;&nbsp;</a></span>_arp_check_own_ip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL W32_CALL _arp_check_own_ip </td>
          <td>(</td>
          <td class="paramtype">eth_address *&#160;</td>
          <td class="paramname"><em>other_guy</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Used by DHCP initialisation. </p>
<p>Do an ARP resolve on our own IP address to check if someone else is replying. Return non-zero if someone replied. </p><dl class="section note"><dt>Note</dt><dd>Blocks waiting for reply or timeout. </dd></dl>

<p class="definition">Definition at line <a class="el" href="pcarp_8c_source.html#l01730">1730</a> of file <a class="el" href="pcarp_8c_source.html">pcarp.c</a>.</p>

</div>
</div>
<a id="a82c9fdc90a238736f7f18d0ceb56a5fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82c9fdc90a238736f7f18d0ceb56a5fb">&#9670;&nbsp;</a></span>_arp_debug_dump()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">W32_CALL <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> W32_CALL _arp_debug_dump </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Debug-dump of configured gateways, route table and ARP cache. </p>
<p>Redone + moved here from <a class="el" href="pcdbug_8c.html">pcdbug.c</a> for encapsulation reasons GvB 2002-09 </p>

<p class="definition">Definition at line <a class="el" href="pcarp_8c_source.html#l01908">1908</a> of file <a class="el" href="pcarp_8c_source.html">pcarp.c</a>.</p>

</div>
</div>
<a id="a8f3fc9371e9f9d67f54cd1939c4cd81b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f3fc9371e9f9d67f54cd1939c4cd81b">&#9670;&nbsp;</a></span>_arp_gateways_get()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int W32_CALL _arp_gateways_get </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structgate__entry.html">gate_entry</a> **&#160;</td>
          <td class="paramname"><em>rc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return start of gate_list[]. </p>
<p>Gateway functions.</p>
<dl class="section note"><dt>Note</dt><dd>Only 'gate_top' gateways are valid in result. </dd></dl>

<p class="definition">Definition at line <a class="el" href="pcarp_8c_source.html#l00095">95</a> of file <a class="el" href="pcarp_8c_source.html">pcarp.c</a>.</p>

</div>
</div>
<a id="aa4f254e7477196929e3ff7a0faa51f6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4f254e7477196929e3ff7a0faa51f6a">&#9670;&nbsp;</a></span>_arp_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL W32_CALL _arp_handler </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structarp___header.html">arp_Header</a> *&#160;</td>
          <td class="paramname"><em>ah</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">BOOL&#160;</td>
          <td class="paramname"><em>brdcast</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Receive ARP handler. </p>
<p>This processes incoming 'raw' ARP packets supplied by <a class="el" href="pctcp_8c.html#a5db19271d908ae67bcfebf2499c6a666" title="Must be called periodically by user application (or BSD socket API). ">tcp_tick()</a>. </p>

<p class="definition">Definition at line <a class="el" href="pcarp_8c_source.html#l01567">1567</a> of file <a class="el" href="pcarp_8c_source.html">pcarp.c</a>.</p>

</div>
</div>
<a id="a793041037e149338bf62932b764c40bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a793041037e149338bf62932b764c40bb">&#9670;&nbsp;</a></span>_arp_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> W32_CALL _arp_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup config-table parse function and add background ARP deamon. </p>
<p>'Internal' interface to <a class="el" href="pctcp_8c.html">pctcp.c</a> &amp; others. </p>

<p class="definition">Definition at line <a class="el" href="pcarp_8c_source.html#l01548">1548</a> of file <a class="el" href="pcarp_8c_source.html">pcarp.c</a>.</p>

<p class="reference">References <a class="el" href="pcarp_8c_source.html#l01495">arp_daemon()</a>.</p>

</div>
</div>
<a id="a690846ce84ecbad4d282c03d32227104"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a690846ce84ecbad4d282c03d32227104">&#9670;&nbsp;</a></span>_arp_lookup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL W32_CALL _arp_lookup </td>
          <td>(</td>
          <td class="paramtype">DWORD&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">eth_address *&#160;</td>
          <td class="paramname"><em>eth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Lookup MAC-address of 'ip'. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TRUE</td><td>MAC for 'ip' is known. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pcarp_8c_source.html#l01187">1187</a> of file <a class="el" href="pcarp_8c_source.html">pcarp.c</a>.</p>

</div>
</div>
<a id="a3f88f6a50d3603359426d0b290af2492"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f88f6a50d3603359426d0b290af2492">&#9670;&nbsp;</a></span>_arp_lookup_fixed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL W32_CALL _arp_lookup_fixed </td>
          <td>(</td>
          <td class="paramtype">DWORD&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">eth_address *&#160;</td>
          <td class="paramname"><em>eth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Lookup fixed MAC-address of 'ip'. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TRUE</td><td>Supplied 'ip' has a fixed MAC entry. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pcarp_8c_source.html#l01220">1220</a> of file <a class="el" href="pcarp_8c_source.html">pcarp.c</a>.</p>

</div>
</div>
<a id="ac5f03b2dc0675fae4f0ce8950db573d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5f03b2dc0675fae4f0ce8950db573d1">&#9670;&nbsp;</a></span>_arp_lookup_pending()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL W32_CALL _arp_lookup_pending </td>
          <td>(</td>
          <td class="paramtype">DWORD&#160;</td>
          <td class="paramname"><em>ip</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>An ARP-lookup timeout check. </p>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TRUE</td><td>The lookup is currently underway ("pending"). </td></tr>
    <tr><td class="paramname">FALSE</td><td>The IP has either been resolved (<a class="el" href="pcarp_8c.html#a690846ce84ecbad4d282c03d32227104" title="Lookup MAC-address of &#39;ip&#39;. ">_arp_lookup()</a> == TRUE), or the lookup has timed out, i.e. the host is unreachable. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pcarp_8c_source.html#l01207">1207</a> of file <a class="el" href="pcarp_8c_source.html">pcarp.c</a>.</p>

</div>
</div>
<a id="ae3b9cb9de75d252c8b08401b298a3b9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3b9cb9de75d252c8b08401b298a3b9f">&#9670;&nbsp;</a></span>_arp_register()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL W32_CALL _arp_register </td>
          <td>(</td>
          <td class="paramtype">DWORD&#160;</td>
          <td class="paramname"><em>use_this_gateway_ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DWORD&#160;</td>
          <td class="paramname"><em>for_this_host_ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register a new host as gateway. </p>
<p>ICMP redirection.</p>
<p>Called on ICMP-redirects.</p>
<p>Redirects are sent from a gateway/router, telling us that a different gateway is better suited to connect to the specified host than the one we were using. </p>

<p class="definition">Definition at line <a class="el" href="pcarp_8c_source.html#l00844">844</a> of file <a class="el" href="pcarp_8c_source.html">pcarp.c</a>.</p>

</div>
</div>
<a id="aba91f5a188640036fc2b32b835c932af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba91f5a188640036fc2b32b835c932af">&#9670;&nbsp;</a></span>_arp_reply()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL W32_CALL _arp_reply </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> *&#160;</td>
          <td class="paramname"><em>e_dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DWORD&#160;</td>
          <td class="paramname"><em>src_ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DWORD&#160;</td>
          <td class="paramname"><em>dst_ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send unicast/broadcast ARP reply. </p>
<p>'src_ip' and 'dst_ip' on host order. </p>

<p class="definition">Definition at line <a class="el" href="pcarp_8c_source.html#l00490">490</a> of file <a class="el" href="pcarp_8c_source.html">pcarp.c</a>.</p>

</div>
</div>
<a id="a0e2f27f4017f14684ebd09ef3c676eaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e2f27f4017f14684ebd09ef3c676eaa">&#9670;&nbsp;</a></span>_arp_resolve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL W32_CALL _arp_resolve </td>
          <td>(</td>
          <td class="paramtype">DWORD&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">eth_address *&#160;</td>
          <td class="paramname"><em>eth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The blocking lookup function visible to higher functions. </p>
<p>Blocking ARP resolve functions. </p>

<p class="definition">Definition at line <a class="el" href="pcarp_8c_source.html#l01280">1280</a> of file <a class="el" href="pcarp_8c_source.html">pcarp.c</a>.</p>

</div>
</div>
<a id="af9153c34822a2449a56dc633429dea4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9153c34822a2449a56dc633429dea4d">&#9670;&nbsp;</a></span>_arp_start_lookup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL W32_CALL _arp_start_lookup </td>
          <td>(</td>
          <td class="paramtype">DWORD&#160;</td>
          <td class="paramname"><em>ip</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>"PUBLIC" ARP/ROUTE FUNCTIONS. </p>
<p>New non-blocking functions, GvB 2002-09.</p>
<p>These are the main functions visible from outside the module. Most of them simply check if the destination host IP is on the LAN or needs to be routed over a gateway, and then relay on to the apropriate LAN_...() or route_...() function. Initialise an ARP lookup. This is called by 'higher' routines to start an ARP request. This function is non-blocking, i.e. returns 'immediately'. </p>

<p class="definition">Definition at line <a class="el" href="pcarp_8c_source.html#l01170">1170</a> of file <a class="el" href="pcarp_8c_source.html">pcarp.c</a>.</p>

</div>
</div>
<a id="ae128add6dce4cf2affb8e076dbea190d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae128add6dce4cf2affb8e076dbea190d">&#9670;&nbsp;</a></span>arp_check_timeouts()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> arp_check_timeouts </td>
          <td>(</td>
          <td class="paramtype">BOOL&#160;</td>
          <td class="paramname"><em>check_dynamic_entries</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check ARP entries for timeout. </p>
<p>This function runs through the 'pending' section of the ARP table and checks for entries that have either expired or require a re-send. The 'dynamic' entries are checked for expiry if requested. </p>

<p class="definition">Definition at line <a class="el" href="pcarp_8c_source.html#l00666">666</a> of file <a class="el" href="pcarp_8c_source.html">pcarp.c</a>.</p>

</div>
</div>
<a id="a4f73b891b4481f0b3d6a38f5dcbfbce2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f73b891b4481f0b3d6a38f5dcbfbce2">&#9670;&nbsp;</a></span>arp_daemon()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> W32_CALL arp_daemon </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>ARP background daemon. </p>
<p>Calls timeout-checks / retransmitters.</p>
<p>We don't check the dynamic entries for a timeout on every call, once a second is plenty enough. </p>

<p class="definition">Definition at line <a class="el" href="pcarp_8c_source.html#l01495">1495</a> of file <a class="el" href="pcarp_8c_source.html">pcarp.c</a>.</p>

</div>
</div>
<a id="a47b5f2ce894307e1bd4d4bc54526660d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47b5f2ce894307e1bd4d4bc54526660d">&#9670;&nbsp;</a></span>compare()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int MS_CDECL compare </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structgate__entry.html">gate_entry</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structgate__entry.html">gate_entry</a> *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compare two entries in gateway-list. </p>
<p>Sort such that entries with the longest netmasks (32-mask_len()) are put first. Thus the default route (mask 0.0.0.0) is matched last in _route_destin().</p>
<p>From <a href="http://www.linuxfoundation.org/collaborate/workgroups/networking/networkoverview:">http://www.linuxfoundation.org/collaborate/workgroups/networking/networkoverview:</a> LPM (Longest Prefix Match) is the lookup algorithm. The route with the longest netmask is the one chosen. Netmask 0, which is the shortest netmask, is for the default gateway. </p>

<p class="definition">Definition at line <a class="el" href="pcarp_8c_source.html#l00218">218</a> of file <a class="el" href="pcarp_8c_source.html">pcarp.c</a>.</p>

<p class="reference">References <a class="el" href="pcarp_8h_source.html#l00014">gate_entry::mask</a>.</p>

</div>
</div>
<a id="a5964e28bfa3e03f2a2d6d38b6e92ddb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5964e28bfa3e03f2a2d6d38b6e92ddb0">&#9670;&nbsp;</a></span>LAN_start_lookup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static BOOL LAN_start_lookup </td>
          <td>(</td>
          <td class="paramtype">DWORD&#160;</td>
          <td class="paramname"><em>ip</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Start a host lookup on the LAN. </p>
<p>This is called by 'higher' routines to start an ARP request. This function is non-blocking, i.e. returns 'immediately'. </p>

<p class="definition">Definition at line <a class="el" href="pcarp_8c_source.html#l00541">541</a> of file <a class="el" href="pcarp_8c_source.html">pcarp.c</a>.</p>

</div>
</div>
<a id="ad50c8a75c1ad7c66322416ce66b39792"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad50c8a75c1ad7c66322416ce66b39792">&#9670;&nbsp;</a></span>route_check_timeouts()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="tcp_8h.html#ac1f7eba6bc7e9c6de5782062335462e6">void</a> route_check_timeouts </td>
          <td>(</td>
          <td class="paramtype">BOOL&#160;</td>
          <td class="paramname"><em>check_dynamic_entries</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Periodic route checker. </p>
<p>Run through all pending entries and check if an attempt to reach a gateway was successfull, or has timed-out. If the attempt timed-out, we try the next fitting gateway. If there are no more fitting gateways to try, the connection has failed. </p>

<p class="definition">Definition at line <a class="el" href="pcarp_8c_source.html#l01047">1047</a> of file <a class="el" href="pcarp_8c_source.html">pcarp.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ab5bb737f6a75f0122c26443f2fae4725"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5bb737f6a75f0122c26443f2fae4725">&#9670;&nbsp;</a></span>icmp_id</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">WORD icmp_id = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Send a ping (with TTL=1) to a gateway. </p>
<p>Ref. RFC-1122. </p>

<p class="definition">Definition at line <a class="el" href="pcarp_8c_source.html#l00106">106</a> of file <a class="el" href="pcarp_8c_source.html">pcarp.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_43e0a1f539e00dcfa1a6bc4d4fee4fc2.html">home</a></li><li class="navelem"><a class="el" href="dir_ab8596c82667c0aca9997b52c5dbee43.html">fosco</a></li><li class="navelem"><a class="el" href="dir_080421ebeac7d91b01d16c10e3428daa.html">src</a></li><li class="navelem"><a class="el" href="dir_6df265bdd26cb50194bab3fa12ccd5e5.html">SSH2DOS</a></li><li class="navelem"><a class="el" href="dir_b1c9b88edcbbea5952d2cf10cb584ddc.html">watt32</a></li><li class="navelem"><a class="el" href="dir_7ffa6a371f53fb7b9b5c8573af96f924.html">src</a></li><li class="navelem"><a class="el" href="pcarp_8c.html">pcarp.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
